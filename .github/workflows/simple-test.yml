name: Simple Tests

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  # 後端基本測試
  backend-basic:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        cd backend
        pip install -r requirements.txt

    - name: Run basic backend tests
      run: |
        cd backend
        python -c "import sys; print('Python version:', sys.version)"
        python -c "import fastapi; print('FastAPI version:', fastapi.__version__)"
        echo "Backend dependencies installed successfully"

  # 前端基本測試
  frontend-basic:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'

    - name: Install dependencies
      run: |
        cd frontend
        npm install

    - name: Check frontend setup
      run: |
        cd frontend
        node --version
        npm --version
        echo "Frontend dependencies installed successfully"

    - name: Build frontend
      run: |
        cd frontend
        npm run build

  # 代碼質量檢查
  code-quality:
    runs-on: ubuntu-latest
    needs: [backend-basic, frontend-basic]

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Check file structure
      run: |
        echo "Checking project structure..."
        ls -la
        echo "Backend files:"
        ls -la backend/
        echo "Frontend files:"
        ls -la frontend/
        echo "GitHub Actions files:"
        ls -la .github/workflows/

    - name: Check configuration files
      run: |
        echo "Checking configuration files..."
        test -f backend/requirements.txt && echo "✅ backend/requirements.txt exists"
        test -f frontend/package.json && echo "✅ frontend/package.json exists"
        test -f docker-compose.yml && echo "✅ docker-compose.yml exists"
        test -f README.md && echo "✅ README.md exists" 